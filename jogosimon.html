<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo Simon Quadrado - Sem Som</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root {
  --verde: #2ecc71;
  --vermelho: #e74c3c;
  --amarelo: #f1c40f;
  --azul: #3498db;
}

body {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  background: linear-gradient(135deg,#74ebd5,#acb6e5);
  font-family: 'Arial', sans-serif;
}

.game-container {
  max-width: 500px;
  min-width: 320px;
  width: 90%;
  aspect-ratio: 1 / 1;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.3);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-around;
  padding: 20px;
  position: relative;
}

.buttons-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  width: 100%;
  height: 60%;
}

.color-button {
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.2s, filter 0.2s, box-shadow 0.2s, opacity 0.2s;
  box-shadow: 0 4px rgba(0,0,0,0.2);
  width: 100%;
  height: 100%;
}

.color-button.active {
  transform: scale(1.1);
  opacity: 0.7;
}

.color-button:active {
  transform: scale(0.95);
}

.controls {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  width: 100%;
  margin-top: 10px;
  gap: 5px;
}

button, select {
  padding: 8px 12px;
  border: none;
  border-radius: 12px;
  background: #3498db;
  color: #fff;
  cursor: pointer;
  font-weight: bold;
  transition: background 0.2s, transform 0.1s;
}

button:hover, select:hover {
  background: #2980b9;
  transform: scale(1.05);
}

#score-display {
  font-size: 1.5rem;
  font-weight: bold;
  margin-top: 5px;
}

#game-over {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0,0,0,0.8);
  color: #fff;
  padding: 25px 35px;
  border-radius: 20px;
  font-size: 1.5rem;
  display: none;
  text-align: center;
  z-index: 10;
}

#ranking-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #fff;
  border-radius: 12px;
  padding: 20px;
  width: 90%;
  max-width: 400px;
  max-height: 80%;
  overflow-y: auto;
  box-shadow: 0 6px 25px rgba(0,0,0,0.3);
  display: none;
  flex-direction: column;
  z-index: 20;
}

#ranking-modal.show {
  display: flex;
}

#ranking-modal h2 {
  margin-bottom: 12px;
  text-align: center;
  font-size: 1.5rem;
  font-weight: bold;
}

#ranking-modal ul {
  list-style: none;
  padding: 0;
}

#ranking-modal ul li {
  padding: 8px 0;
  border-bottom: 1px solid #ddd;
  text-align: center;
  font-weight: bold;
}

#ranking-modal button {
  margin-top: 12px;
  width: 100%;
  background: #e74c3c;
  cursor: pointer;
}

select {
  padding: 5px 10px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}
</style>
</head>
<body>
<div class="game-container">
  <h1 class="text-2xl font-bold mb-2">Jogo Simon</h1>
  
  <div class="buttons-grid">
    <div id="green" class="color-button" style="background: var(--verde);"></div>
    <div id="red" class="color-button" style="background: var(--vermelho);"></div>
    <div id="yellow" class="color-button" style="background: var(--amarelo);"></div>
    <div id="blue" class="color-button" style="background: var(--azul);"></div>
  </div>

  <div id="score-display">Nível: 0</div>

  <div class="controls">
    <button id="start-btn">Iniciar Jogo</button>
    <button id="instructions-btn">Instruções</button>
    <button id="ranking-btn">Ranking</button>
    <select id="daltonism-select">
      <option value="none">Normal</option>
      <option value="protanopia">Protanopia</option>
      <option value="deuteranopia">Deuteranopia</option>
      <option value="tritanopia">Tritanopia</option>
    </select>
  </div>

  <div id="game-over">Game Over!<br>Nível alcançado: <span id="final-level">0</span></div>
</div>

<div id="ranking-modal" class="flex">
  <h2>Ranking</h2>
  <ul id="ranking-list"></ul>
  <button id="close-ranking">Fechar</button>
</div>

<script>
let sequence = [];
let playerSequence = [];
let level = 0;
let colors = ["green", "red", "yellow", "blue"];
let daltonMode = "none";
let playingSequence = false;

// Daltonismo
function applyDaltonism() {
  const buttons = document.querySelectorAll('.color-button');
  buttons.forEach(btn => btn.style.filter = 'none');
  if(daltonMode === "protanopia") {
    document.getElementById('green').style.filter = 'brightness(0.7)';
    document.getElementById('red').style.filter = 'grayscale(70%)';
  }
  if(daltonMode === "deuteranopia") {
    document.getElementById('green').style.filter = 'grayscale(70%)';
    document.getElementById('red').style.filter = 'brightness(0.7)';
  }
  if(daltonMode === "tritanopia") {
    document.getElementById('blue').style.filter = 'grayscale(70%)';
    document.getElementById('yellow').style.filter = 'brightness(0.7)';
  }
}

// Botões piscando
function highlightButton(color) {
  return new Promise(resolve => {
    const btn = document.getElementById(color);
    btn.classList.add('active');
    setTimeout(() => {
      btn.classList.remove('active');
      setTimeout(resolve, 150);
    }, 400);
  });
}

// Sequência
async function playSequence() {
  playingSequence = true;
  for(let color of sequence){
    await highlightButton(color);
  }
  playingSequence = false;
}

// Próximo nível
function nextLevel() {
  level++;
  playerSequence = [];
  document.getElementById('score-display').innerText = 'Nível: ' + level;
  let randomColor = colors[Math.floor(Math.random() * 4)];
  sequence.push(randomColor);
  playSequence();
}

// Clique do jogador
function handleClick(color) {
  if(playingSequence) return;
  playerSequence.push(color);
  highlightButton(color);
  checkSequence();
}

// Checar sequência
function checkSequence() {
  for(let i=0; i<playerSequence.length; i++){
    if(playerSequence[i] !== sequence[i]){
      gameOver();
      return;
    }
  }
  if(playerSequence.length === sequence.length){
    setTimeout(nextLevel, 500);
  }
}

// Game over
function gameOver() {
  document.getElementById('final-level').innerText = level;
  document.getElementById('game-over').style.display = 'block';
  saveScore(level);
  sequence = [];
  playerSequence = [];
  level = 0;
  setTimeout(() => {
    document.getElementById('score-display').innerText = 'Nível: 0';
    document.getElementById('game-over').style.display = 'none';
  }, 2000);
}

// Ranking
function saveScore(score) {
  let scores = JSON.parse(localStorage.getItem('simonScores')) || [];
  scores.push(score);
  scores.sort((a,b)=>b-a);
  scores = scores.slice(0, 10);
  localStorage.setItem('simonScores', JSON.stringify(scores));
}

function showRanking() {
  const modal = document.getElementById('ranking-modal');
  const list = document.getElementById('ranking-list');
  list.innerHTML = '';
  let scores = JSON.parse(localStorage.getItem('simonScores')) || [];
  if(scores.length === 0) list.innerHTML = '<li>Sem pontuações ainda</li>';
  else scores.forEach((score,index) => list.innerHTML += `<li>${index+1}. Nível ${score}</li>`);
  modal.classList.add('show');
}

// Eventos
document.getElementById('start-btn').addEventListener('click', () => {
  sequence = [];
  level = 0;
  document.getElementById('score-display').innerText = 'Nível: 0';
  nextLevel();
});

document.getElementById('instructions-btn').addEventListener('click', () => {
  alert("Siga a sequência de cores e repita clicando nos quadrados. Cada rodada aumenta a sequência.");
});

document.getElementById('ranking-btn').addEventListener('click', showRanking);
document.getElementById('close-ranking').addEventListener('click', () => {
  document.getElementById('ranking-modal').classList.remove('show');
});

document.getElementById('daltonism-select').addEventListener('change', (e)=>{
  daltonMode = e.target.value;
  applyDaltonism();
});

colors.forEach(color => {
  document.getElementById(color).addEventListener('click', () => handleClick(color));
});
</script>
</body>
</html>
